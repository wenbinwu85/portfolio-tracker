<section *ngIf="priceChangeChartData.length > 0" class="add-border">
    <div class="add-flex">
        <div class="title">
            <span>Portfolio Value Change</span>
        </div>    
        <mat-chip-listbox [ngStyle]="{'padding-right': '1.25rem'}">
            <mat-chip-option selected (click)="displayChart(1)">Today's Change</mat-chip-option>
            <mat-chip-option (click)="displayChart(2)">Beta</mat-chip-option>
        </mat-chip-listbox>
    </div>

    <div class="return-wrapper">
        <div *ngIf="!prefix.startsWith('pre')" class="add-flex">
            <span>Regular Market </span>
            <mat-icon>schedule</mat-icon>
            <span [ngStyle]="{ color: getDayPriceChangeColor() }">
                {{ priceChange | currency }}
            </span>
            <span [ngStyle]="{ color: getDayPriceChangeColor() }">
                ({{ priceChange / portfolioHoldings.portfolioMarketValue | percent: '.4' }})
            </span>
        </div>

        <div *ngIf="!prefix.startsWith('regular')" class="add-flex">
            <span>{{ prePostHourText }}</span>
            <mat-icon>{{ prePostHourIcon }}</mat-icon>
            <span [ngStyle]="{ color: getPrePostPriceChangeColor() }">
                {{ prePostMarketPriceChange | currency }}
            </span>
            <span [ngStyle]="{ color: getPrePostPriceChangeColor() }">
                ({{ prePostMarketPriceChange / portfolioHoldings.portfolioMarketValue | percent: '.4' }})
            </span>
        </div>

        <mat-slide-toggle *ngIf="!prefix.startsWith('pre')" (toggleChange)="changeChart()">
            <span>Post Market Chart</span>
        </mat-slide-toggle>
    </div>

    <div *ngIf="selectedChart === 1" class="add-flex">
        <div class="chart-container">
            <ngx-charts-bar-vertical
                [results]="priceChangeChartData"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [rotateXAxisTicks]="true"
                [animations]="true"
                [showDataLabel]="true"
                [yAxisLabel]="'Price Change %'"
                [customColors]="getPriceChangeChartColor"
            >
                <ng-template #tooltipTemplate let-model="model">
                    <tv-mini-chart-widget [symbol]="model.name" [theme]="'dark'"/>
                    <mat-divider style="margin: none; border-top-color: slategrey"/>
                    <span>Pre/Post: {{ model.name }} </span>
                    <span>{{ model.value.toFixed(2) }}%</span>
                </ng-template>
            </ngx-charts-bar-vertical>
        </div>
        <div class="chart-container">
            <ngx-charts-bar-vertical-stacked
                [scheme]="priceRangeColorScheme"
                [results]="priceRangeChartData"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [rotateXAxisTicks]="true"
                [animations]="true"
                [yAxisLabel]="'Market Day Price Range $'"
            />
        </div>
    </div>

    <div *ngIf="selectedChart === 2" class="add-flex">
        <div class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="betaColorScheme"
                [schemeType]="scaleType.Linear"
                [results]="betaChartData"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [rotateXAxisTicks]="true"
                [animations]="true"
                [yAxisLabel]="'Beta'"
            />
        </div>
    </div>

    <mat-expansion-panel [expanded]="expandQuotes">
        <mat-expansion-panel-header>
            <mat-panel-title>
              <mat-icon>price_change</mat-icon>
              <span>Price Quotes</span>
            </mat-panel-title>
          </mat-expansion-panel-header>
        <tv-market-quotes-widget [stockNames]="stockNames" [height]="410" />
    </mat-expansion-panel>
</section>