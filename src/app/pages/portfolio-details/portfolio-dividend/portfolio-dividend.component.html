<section *ngIf="infoCards" class="dividend-cards-container">
  <ng-container *ngFor="let card of infoCards">
    <info-card 
      [icon]="card.icon"
      [value]="card.value"
      [valueType]="card.valueType"
      [subtitle]="card.subtitle"
      [color]="card.color"
      [accentColor]="card.color"
    />
  </ng-container>
</section>

<mat-divider />

<section *ngIf="browser === 'Safari'" class="add-border">
  <div class="add-flex">
    <span class="title">Dividend History</span>
    <button mat-button color="primary" class="refresh-button" (click)="refreshDividend(selectedSymbol, false)">
      <mat-icon>cloud_sync</mat-icon>
      <span>Refresh Dividend History</span>
    </button>
  </div>
  <div class="safari-charts-container">
    <echarts-vertical-bar-chart [options]="echartOptions" />
    <div class="chart-container dividend-pie">
      <ngx-charts-pie-chart
        [scheme]="'picnic'"
        [results]="pieChartData"
        [animations]="true"
        [explodeSlices]="true"
        [labels]="true"
        [legend]="true"
        [arcWidth]=".75"
        (select)="onSelect($event)"
        (activate)="onActivate($event)"
        (deactivate)="onDeactivate($event)"
      />
    </div>
  </div>
</section>

<section *ngIf="browser !== 'Safari'" class="add-border">
  <div class="add-flex">
    <span class="title">Dividend History</span>
    <button mat-button color="primary" class="refresh-button" (click)="refreshDividend(selectedSymbol, false)">
      <mat-icon>cloud_sync</mat-icon>
      <span>Refresh Dividend History</span>
    </button>
  </div>

  <div class="add-flex">
    <div *ngIf="dividendLineChartData" class="chart-container dividend-chart">
      <ngx-charts-area-chart
        [scheme]="dividendChartColorScheme"
        [results]="dividendLineChartData"
        [xAxisLabel]="selectedSymbolLabel"
        [yAxisLabel]="'Dividend Rate'"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        [xAxis]="true"
        [yAxis]="true"
        [autoScale]="true"
        [animations]="true"
        [gradient]="true"
        [yScaleMin]="0"
      />
    </div>
  
    <div class="chart-container dividend-pie">
      <ngx-charts-pie-chart
        [scheme]="'picnic'"
        [results]="pieChartData"
        [animations]="true"
        [explodeSlices]="true"
        [labels]="true"
        [legend]="true"
        [arcWidth]=".75"
        (select)="onSelect($event)"
        (activate)="onActivate($event)"
        (deactivate)="onDeactivate($event)"
      />
    </div>
  </div>
</section>

<table mat-table matSort matSortActive="yieldOnCost" matSortDirection="desc" [dataSource]="dataSource">
  <ng-container *ngFor="let column of columnDefs; index as cidx" [matColumnDef]="column">
    <th *matHeaderCellDef mat-header-cell mat-sort-header>{{ headers[cidx] }}</th>
    <td mat-cell *matCellDef="let stock">
      <div *ngIf="cidx === 0; else elseBlock" class="table-col-0">
        <stock-name-card [stock]="stock" />
      </div>
      <ng-template #elseBlock>
        <span (click)="refreshDividend(stock.symbol, true)">{{ cells[cidx](stock) }}</span>
      </ng-template>
    </td>
  </ng-container>
  <tr mat-header-row *matHeaderRowDef="columnDefs; sticky: true"></tr>
  <tr mat-row *matRowDef="let row; columns: columnDefs"></tr>
</table>