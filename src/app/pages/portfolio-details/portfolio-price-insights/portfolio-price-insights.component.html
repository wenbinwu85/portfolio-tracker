<stock-price-movement-charts />

<section class="add-border">
    <div class="add-flex">
        <div class="title">Price Insights</div>
        <button mat-button extended color="primary" class="refresh-button" (click)="refreshData()">
            <mat-icon>cloud_sync</mat-icon>
            <span>Refresh Technical Insights</span>
        </button>
    </div>
    <div class="logos-container">
        <button
            *ngFor="let stock of sortedStocks" 
            mat-button 
            class="ticker-button" 
            (click)="updateSelectedStock(stock.symbol)"
        >
            <img
                [src]="getLogoSource(stock)" 
                alt="Logo" 
                width="auto" 
                height="35"
            />
            <div>{{ stock.symbol }}</div>
        </button>
        <button
            *ngFor="let etf of sortedEtfs" 
            mat-button 
            class="ticker-button" 
            (click)="updateSelectedStock(etf.symbol)"
        >
            <img
                [src]="getLogoSource(etf)" 
                alt="Logo" 
                width="auto" 
                height="35" 
            />
            <div>{{ etf.symbol }}</div>
        </button>
    </div>

    <mat-divider />

    <div *ngIf="selectedSymbol">
        <stock-price-insight [symbol]="selectedSymbol" />
    </div>
</section>

<section class="add-border">
    <div class="chart-header">
        <div class="title">
            <span>Performance</span>
        </div>
        <mat-chip-listbox [ngStyle]="{'padding-right': '1.25rem'}">
            <mat-chip-option selected (click)="changePerformanceChart(1)">Moving Averages</mat-chip-option>
            <mat-chip-option (click)="changePerformanceChart(2)">ETFs Performance</mat-chip-option>
        </mat-chip-listbox>
    </div>
    <div class="add-flex">
        <div *ngIf="selectedPerformanceChart === 1" class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="performanceChartColorScheme"
                [results]="fiftyDayMAChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yAxisLabel]="'Price vs 50 Day MA %'"
                [yScaleMin]="fiftyDayMAChartData[0].value - 5"
                [customColors]="[selectedSymbolColor]"
            >
            </ngx-charts-bar-vertical>

        </div> 
        <div *ngIf="selectedPerformanceChart === 1" class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="performanceChartColorScheme"
                [results]="twoHundredDayMAChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yAxisLabel]="'Price vs 200 Day MA %'"
                [yScaleMin]="twoHundredDayMAChartData[0].value - 5"
                [customColors]="[selectedSymbolColor]"
            >
            </ngx-charts-bar-vertical>
        </div> 
        <div *ngIf="selectedPerformanceChart === 1" class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="performanceChartColorScheme"
                [results]="fiftyTwoWeekChangeChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yAxisLabel]="'52 Week Change %'"
                [activeEntries]="['S&P 500']"
                [customColors]="[selectedSymbolColor, {name:'S&P 500', value: 'gold'}]"
            >
            </ngx-charts-bar-vertical>
        </div>
    </div>
    <div *ngIf="selectedPerformanceChart === 2" class="chart-container">
        <ngx-charts-bar-vertical-2d
            [results]="etfPerformanceChartData"
            [animations]="true"
            [xAxis]="true"
            [yAxis]="true"
            [showXAxisLabel]="true"
            [showYAxisLabel]="true"
            [legend]="false"
            [showDataLabel]="true"
            [rotateXAxisTicks]="true"
            [yAxisLabel]="'ETF Performance %'"
            [customColors]="[
                {name: 'SCHD', value: 'deepskyblue'},
                {name: 'VYM', value: 'maroon'}, 
                {name: 'JEPI', value: 'dodgerblue'}
            ]"
        >
        </ngx-charts-bar-vertical-2d>
    </div>
</section>

<section class="add-border">
    <div class="chart-header">
        <div class="title">
            <span>Price vs 52 Week & Analyst Target</span>
        </div>
        <!-- <mat-chip-listbox [ngStyle]="{padding-right: '1.5rem'}">
            <mat-chip-option selected (click)="changeVSCharts(1)">VS 52 Week High Low</mat-chip-option>
            <mat-chip-option (click)="changeVSCharts(2)">VS Target Price</mat-chip-option>
        </mat-chip-listbox> -->
    </div>
    <div class="add-flex">
        <div class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="fiftyTwoWeekChartColorScheme"
                [results]="fiftyTwoWeekLowChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yAxisLabel]="'Price % above 52 week low'"
                [customColors]="[selectedSymbolColor]"
            >
            </ngx-charts-bar-vertical>
        </div> 
        <div class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="fiftyTwoWeekChartColorScheme"
                [results]="fiftyTwoWeekHighChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yAxisLabel]="'Price % below 52 week high'"
                [customColors]="[selectedSymbolColor]"
            >
            </ngx-charts-bar-vertical>
        </div>
        <div class="chart-container">
            <ngx-charts-bar-vertical
                [scheme]="targetPriceChartColorScheme"
                [results]="discountChartData"
                [animations]="true"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="true"
                [showYAxisLabel]="true"
                [legend]="false"
                [rotateXAxisTicks]="true"
                [yScaleMin]="-5"
                [yAxisLabel]="'Price % vs mean target price'"
                [customColors]="[selectedSymbolColor]"
            >
            </ngx-charts-bar-vertical>
        </div> 
    </div>
</section>
