import{b as M}from"./chunk-WEW3ZV5E.js";import{h as A}from"./chunk-MPDQPMGY.js";import{t as T}from"./chunk-KBUGW7X4.js";import{a as H,b as _,f as I}from"./chunk-U5KDJIWP.js";import{Ja as c,O as g,R as f,Ra as b,Sa as C,Ta as p,Ua as m,V as y,Va as d,Wb as D,Xb as v,Yb as S,qa as l,ra as u,sb as w,xc as h}from"./chunk-HI56ZCOM.js";var P=(()=>{let e=class e{constructor(i,a){this.http=i,this.dataService=a,this.apiBaseUrl="https://data.alpaca.markets",this.apiKey="PK41CNLBVKS2CHYHD6FQ",this.secretKey="hOurdDodVN23wnjowMOyXYjeaobsmIbXtqhOwSbE",this.httpHeaders=new D().set("APCA-API-KEY-ID",this.apiKey).set("APCA-API-SECRET-KEY",this.secretKey)}getLatestBars(){let i=this.dataService.portfolioSymbols,a=this.apiBaseUrl+"/v2/stocks/bars/latest",n=new v().appendAll({symbols:i.join(","),feed:"iex"}),s={headers:this.httpHeaders,params:n};return this.dataService.wrapHttpCall(a,s)}getNews(i,a,n,s){let t=this.apiBaseUrl+"/v1beta1/alpaca/fetch/news/",x=new v().appendAll({symbols:i.join(","),start:a,end:n,limit:s}),j={headers:this.httpHeaders,params:x};return this.dataService.wrapHttpCall(t,j)}};e.\u0275fac=function(a){return new(a||e)(f(S),f(h))},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var O=(r,e)=>e.epochGradeDate,Y=(r,e)=>e.index;function K(r,e){if(r&1&&d(0,"info-card",6)(1,"div",7),r&2){let o=e.$implicit;c("value",o.fromGrade+" to "+o.toGrade)("subtitle",o.symbol)("subtitleChip",!0)("additionalInfo",o.firm)("date",(o.epochGradeDate*1e3).toString())("icon",o.icon)("color",o.color)}}function W(r,e){if(r&1&&d(0,"info-card",6)(1,"div",7),r&2){let o=e.$implicit;c("value",o.shares.fmt+" shares. "+o.transactionText)("subtitle",o.symbol)("subtitleChip",!0)("additionalInfo",o.filerName+", "+o.filerRelation)("date",(o.startDate.raw*1e3).toString())("icon",o.icon)("color",o.color)}}var Z=(()=>{let e=class e{constructor(i,a){this.alpacaApiService=i,this.dataService=a,this.selectedChart=1,this.gradingHistory=[],this.insiderActivities=[]}ngOnInit(){this.dataService.portfolioDataArray.forEach(i=>{let a={up:"thumb_up",down:"thumb_down",main:"thumbs_up_down",reit:"thumbs_up_down"};if(i.quoteType==="EQUITY"){let n=Object.values(i.upgradeDowngradeHistory).filter(t=>new Date(t.epochGradeDate*1e3).getFullYear()===new Date().getFullYear()).map(t=>(t.symbol=i.symbol,t.icon=a[t.action],t.action==="up"&&(t.color="teal"),t.action==="down"&&(t.color="chocolate"),t));this.gradingHistory.push(...n);let s=i.insiderTransactions;s.length>0&&this.insiderActivities.push(...s.filter(t=>new Date(t.startDate.raw*1e3).getFullYear()===new Date().getFullYear()&&(t.transactionText.startsWith("Purchase")||t.transactionText.startsWith("Sale"))).map(t=>(t.symbol=i.symbol,t.transactionText.startsWith("Purchase")?(t.icon="sentiment_very_satisfied",t.color="teal"):t.transactionText.startsWith("Sale")&&(t.icon="sentiment_very_dissatisfied",t.color="chocolate"),t)))}}),this.gradingHistory.sort((i,a)=>a.epochGradeDate-i.epochGradeDate),this.insiderActivities.sort((i,a)=>a.startDate.raw-i.startDate.raw)}selectChart(i){this.selectedChart=i}};e.\u0275fac=function(a){return new(a||e)(u(P),u(h))},e.\u0275cmp=y({type:e,selectors:[["app-portfolio-main"]],standalone:!0,features:[w],decls:12,vars:1,consts:[["mat-align-tabs","center"],["label","Quotes"],[1,"add-margin"],[3,"expandWidget"],["label","Grading History"],["label","Insider Activities"],[3,"value","subtitle","subtitleChip","additionalInfo","date","icon","color"],[1,"spacer"]],template:function(a,n){a&1&&(p(0,"mat-tab-group",0)(1,"mat-tab",1)(2,"section",2),d(3,"portfolio-quotes",3),m()(),p(4,"mat-tab",4)(5,"section",2),b(6,K,2,7,null,null,O),m()(),p(8,"mat-tab",5)(9,"section",2),b(10,W,2,7,null,null,Y),m()()()),a&2&&(l(3),c("expandWidget",!0),l(3),C(n.gradingHistory),l(4),C(n.insiderActivities))},dependencies:[A,T,I,H,_,M],styles:[".grading-history-container[_ngcontent-%COMP%]{display:flex}.spacer[_ngcontent-%COMP%]{height:.5rem}info-card[_ngcontent-%COMP%]{min-width:fit-content}"]});let r=e;return r})();export{Z as a};
