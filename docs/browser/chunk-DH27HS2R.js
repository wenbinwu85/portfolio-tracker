import{b as P}from"./chunk-KNS2LFWM.js";import{h as j}from"./chunk-NGUUMGIV.js";import{t as T}from"./chunk-PRNO7TR7.js";import{a as A,b as I,f as M}from"./chunk-2IXY4EFG.js";import{Bc as x,Cc as h,Ea as w,Ja as p,O as _,Oa as u,R as f,Ra as b,Sa as C,Ta as m,Ua as c,V as y,Va as d,Wb as S,Xb as v,Yb as D,cb as g,qa as s,ra as l,sb as H}from"./chunk-A2FSG2YQ.js";var E=(()=>{class i{constructor(t,a){this.http=t,this.dataService=a,this.apiBaseUrl="https://data.alpaca.markets",this.apiKey="PK41CNLBVKS2CHYHD6FQ",this.secretKey="hOurdDodVN23wnjowMOyXYjeaobsmIbXtqhOwSbE",this.httpHeaders=new S().set("APCA-API-KEY-ID",this.apiKey).set("APCA-API-SECRET-KEY",this.secretKey)}getLatestBars(){let t=this.dataService.portfolioSymbols,a=this.apiBaseUrl+"/v2/stocks/bars/latest",o=new v().appendAll({symbols:t.join(","),feed:"iex"}),r={headers:this.httpHeaders,params:o};return this.dataService.wrapHttpCall(a,r)}getNews(t,a,o,r){let e=this.apiBaseUrl+"/v1beta1/alpaca/fetch/news/",F=new v().appendAll({symbols:t.join(","),start:a,end:o,limit:r}),G={headers:this.httpHeaders,params:F};return this.dataService.wrapHttpCall(e,G)}static{this.\u0275fac=function(a){return new(a||i)(f(D),f(h))}}static{this.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var W=(i,n)=>n.epochGradeDate,U=(i,n)=>n.index;function B(i,n){if(i&1&&d(0,"info-card",6)(1,"div",7),i&2){let t=n.$implicit;p("value",t.fromGrade+" to "+t.toGrade)("subtitle",t.symbol)("subtitleChip",!0)("additionalInfo",t.firm)("date",(t.epochGradeDate*1e3).toString())("icon",t.icon)("color",t.color)}}function N(i,n){if(i&1&&(m(0,"mat-tab",4)(1,"section",2),b(2,B,2,7,null,null,W),c()()),i&2){let t=g();s(2),C(t.gradingHistory)}}function Q(i,n){if(i&1&&d(0,"info-card",6)(1,"div",7),i&2){let t=n.$implicit;p("value",t.shares.fmt+" shares. "+t.transactionText)("subtitle",t.symbol)("subtitleChip",!0)("additionalInfo",t.filerName+", "+t.filerRelation)("date",(t.startDate.raw*1e3).toString())("icon",t.icon)("color",t.color)}}function $(i,n){if(i&1&&(m(0,"mat-tab",5)(1,"section",2),b(2,Q,2,7,null,null,U),c()()),i&2){let t=g();s(2),C(t.insiderActivities)}}var nt=(()=>{class i{constructor(t,a,o){this.alpacaApiService=t,this.dataService=a,this.firebaseService=o,this.selectedChart=1,this.gradingHistory=[],this.insiderActivities=[]}ngOnInit(){this.dataService.portfolioDataArray.forEach(t=>{let a={up:"thumb_up",down:"thumb_down",main:"thumbs_up_down",reit:"thumbs_up_down"};if(t.quoteType==="EQUITY"){let o=Object.values(t.upgradeDowngradeHistory).filter(e=>new Date(e.epochGradeDate*1e3).getFullYear()===new Date().getFullYear()).map(e=>(e.symbol=t.symbol,e.icon=a[e.action],e.action==="up"&&(e.color="teal"),e.action==="down"&&(e.color="chocolate"),e));this.gradingHistory.push(...o);let r=t.insiderTransactions;r.length>0&&this.insiderActivities.push(...r.filter(e=>new Date(e.startDate.raw*1e3).getFullYear()===new Date().getFullYear()&&(e.transactionText.startsWith("Purchase")||e.transactionText.startsWith("Sale"))).map(e=>(e.symbol=t.symbol,e.transactionText.startsWith("Purchase")?(e.icon="sentiment_very_satisfied",e.color="teal"):e.transactionText.startsWith("Sale")&&(e.icon="sentiment_very_dissatisfied",e.color="chocolate"),e)))}}),this.gradingHistory.sort((t,a)=>a.epochGradeDate-t.epochGradeDate),this.insiderActivities.sort((t,a)=>a.startDate.raw-t.startDate.raw)}selectChart(t){this.selectedChart=t}static{this.\u0275fac=function(a){return new(a||i)(l(E),l(h),l(x))}}static{this.\u0275cmp=y({type:i,selectors:[["app-homepage"]],standalone:!0,features:[H],decls:6,vars:3,consts:[["mat-align-tabs","center"],["label","Quotes"],[1,"add-margin"],[3,"expandWidget"],["label","Grading History"],["label","Insider Activities"],[3,"value","subtitle","subtitleChip","additionalInfo","date","icon","color"],[1,"spacer"]],template:function(a,o){a&1&&(m(0,"mat-tab-group",0)(1,"mat-tab",1)(2,"section",2),d(3,"portfolio-quotes",3),c()(),w(4,N,4,0,"mat-tab",4)(5,$,4,0,"mat-tab",5),c()),a&2&&(s(3),p("expandWidget",!0),s(),u(o.gradingHistory.length?4:-1),s(),u(o.insiderActivities.length?5:-1))},dependencies:[j,T,M,A,I,P],styles:[".grading-history-container[_ngcontent-%COMP%]{display:flex}.spacer[_ngcontent-%COMP%]{height:.5rem}info-card[_ngcontent-%COMP%]{min-width:fit-content}"]})}}return i})();export{nt as a};
