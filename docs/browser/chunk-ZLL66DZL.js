import{t as b,u as l,v as w}from"./chunk-RNTJAAAV.js";import{C as d,N as g,g as h,m as c,ma as u,w as f,wa as m}from"./chunk-FNNUKVD3.js";import{a as r,b as n}from"./chunk-MON7YFGF.js";var y=(()=>{let a=class a{constructor(t){this.http=t,this.httpOptions={headers:new b().set("content-type","application/json").set("Access-Control-Allow-Origin","*")},this.backendDataPath="../../../backend/data/",this.backendUrl="http://127.0.0.1:5000",this.isLoadingData=new h(!1),this.updatePortfolioData(!1)}error(t){let o=t.error instanceof ErrorEvent?t.error.message:`Error Code: ${t.status} Message: ${t.message}`;return c({data:[],message:o,status:500})}wrapHttpCall(t,o=this.httpOptions){return this.http.get(t,o).pipe(g(2),d(this.error))}updatePortfolioData(t){this.isLoadingData.next(!0),console.log("loading true..."),f([this.getPortfolioData(t),this.getPortfolioHoldings()]).subscribe(([o,s])=>{this.portfolioData=o,this.portfolioHoldings=s,this.portfolioSymbols=Object.keys(this.portfolioData),this.isLoadingData.next(!1),t&&location.reload(),console.log("--- sanity check ---"),console.table(Object.entries(this.portfolioHoldings))})}getPortfolioHoldings(){let t=`${this.backendUrl}/fetch/portfolio/holdings`;return this.wrapHttpCall(t)}getPortfolioSymbols(){let t=`${this.backendUrl}/fetch/portfolio/symbols`;return this.wrapHttpCall(t)}getPortfolioData(t){let o=`${this.backendUrl}/fetch/portfolio/data`;if(t!==null){let s=new l().set("update",String(t)),i=n(r({},this.httpOptions),{params:s});return this.wrapHttpCall(o,i)}return this.wrapHttpCall(o)}getStockData(t,o){let s=`${this.backendUrl}/fetch/stock/${t}`;if(o!==null){let i=new l().set("save",String(o)),e=n(r({},this.httpOptions),{params:i});return this.wrapHttpCall(s,e)}return this.wrapHttpCall(s)}getStocksData(t,o){let s=`${this.backendUrl}/fetch/stocks/`+t.join(":");if(o!==null){let i=new l().set("save",String(o)),e=n(r({},this.httpOptions),{params:i});return this.wrapHttpCall(s,e)}return this.wrapHttpCall(s)}loadStockDataFromDataFolder(t){let o=`${this.backendDataPath}${t.toLowerCase()}.json`,s=n(r({},this.httpOptions),{responseType:"json"});return this.wrapHttpCall(o,s)}getDividendHistory(t,o=10,s=!1){let i=`${this.backendUrl}/fetch/dividend-history/${t}`,e=new l;e=e.set("update",String(s)),e=e.set("years",o);let H=n(r({},this.httpOptions),{params:e});return this.wrapHttpCall(i,H)}getTechnicalInsights(t){let o=`${this.backendUrl}/fetch/technical-insights/${t}`;return this.wrapHttpCall(o)}getRecommendations(t){let o=`${this.backendUrl}/fetch/recommendations/${t}`;return this.wrapHttpCall(o)}getCorporateEvents(t){let o=`${this.backendUrl}/fetch/events/${t}`;return this.wrapHttpCall(o)}};a.\u0275fac=function(o){return new(o||a)(m(w))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let p=a;return p})();export{y as a};
