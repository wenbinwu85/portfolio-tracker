import{b as B}from"./chunk-XPA574VU.js";import{a as G,b as N,f as U}from"./chunk-OSUIEARW.js";import{a as K}from"./chunk-LQPWDKSD.js";import{k as W}from"./chunk-FRAQJFKH.js";import{g as Y,h as X,i as j}from"./chunk-DZQDODP3.js";import{a as V,b as M,c as k,p as y}from"./chunk-7TW437ZA.js";import{f as F}from"./chunk-6NO5WZFX.js";import{$b as A,Ab as s,B as S,Bb as c,Cb as p,Gb as O,Jb as u,Lb as h,M as I,Vb as D,Wb as w,X as H,Xa as l,Ya as g,aa as b,fa as R,hc as E,l as P,na as f,oa as _,ob as x,qb as r,vb as C,yb as v,zb as T}from"./chunk-QSIP5JXX.js";var $=(()=>{let n=class n{constructor(e,i){this.http=e,this.dataService=i,this.apiBaseUrl="https://data.alpaca.markets",this.apiKey="PK41CNLBVKS2CHYHD6FQ",this.secretKey="hOurdDodVN23wnjowMOyXYjeaobsmIbXtqhOwSbE",this.httpHeaders=new V().set("APCA-API-KEY-ID",this.apiKey).set("APCA-API-SECRET-KEY",this.secretKey)}error(e){let i=e.error instanceof ErrorEvent?e.error.message:`Error Code: ${e.status} Message: ${e.message}`;return P({data:[],message:i,status:500})}wrapHttpCall(e,i){return this.http.get(e,i).pipe(I(2),S(this.error))}getLatestBars(){let e=this.dataService.portfolioSymbols,i=this.apiBaseUrl+"/v2/stocks/bars/latest",m=new M().appendAll({symbols:e.join(","),feed:"iex"}),d={headers:this.httpHeaders,params:m};return this.wrapHttpCall(i,d)}getNews(e,i,m,d){let a=this.apiBaseUrl+"/v1beta1/alpaca/fetch/news/",q=new M().appendAll({symbols:e.join(","),start:i,end:m,limit:d}),Q={headers:this.httpHeaders,params:q};return this.wrapHttpCall(a,Q)}};n.\u0275fac=function(i){return new(i||n)(b(k),b(y))},n.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var Z=(t,n)=>n.epochGradeDate,tt=(t,n)=>n.index;function et(t,n){if(t&1){let o=O();s(0,"div",9)(1,"mat-chip-listbox")(2,"mat-chip-option",10),u("click",function(){f(o);let i=h();return _(i.selectChart(1))}),w(3,"S&P | DJI"),c(),s(4,"mat-chip-option",11),u("click",function(){f(o);let i=h();return _(i.selectChart(2))}),w(5,"Nasdaq | Russell"),c(),s(6,"mat-chip-option",11),u("click",function(){f(o);let i=h();return _(i.selectChart(3))}),w(7,"VIX"),c(),s(8,"mat-chip-option",11),u("click",function(){f(o);let i=h();return _(i.selectChart(4))}),w(9,"Cryptos"),c(),s(10,"mat-chip-option",11),u("click",function(){f(o);let i=h();return _(i.selectChart(5))}),w(11,"Forex"),c()()()}}function it(t,n){t&1&&p(0,"wallmine-chart",13)(1,"wallmine-chart",13),t&2&&(r("symbol","INDEX:GSPC")("width","50%"),l(),r("symbol","INDEX:DJI")("width","50%"))}function nt(t,n){t&1&&p(0,"wallmine-chart",13)(1,"wallmine-chart",13),t&2&&(r("symbol","INDEX:IXIC")("width","50%"),l(),r("symbol","INDEX:RUT")("width","50%"))}function ot(t,n){t&1&&p(0,"wallmine-chart",12),t&2&&r("symbol","INDEX:VIX")}function at(t,n){t&1&&p(0,"wallmine-chart",13)(1,"wallmine-chart",13)(2,"wallmine-chart",13),t&2&&(r("symbol","CRYPTO:BTC")("width","33.33%"),l(),r("symbol","CRYPTO:ETH")("width","33.33%"),l(),r("symbol","CRYPTO:DOGE")("width","33.33%"))}function rt(t,n){t&1&&p(0,"wallmine-chart",13)(1,"wallmine-chart",13)(2,"wallmine-chart",13),t&2&&(r("symbol","FOREX:USDCNY")("width","33.33%"),l(),r("symbol","FOREX:USDJPY")("width","33.33%"),l(),r("symbol","FOREX:USDEUR")("width","33.33%"))}function lt(t,n){if(t&1&&x(0,it,2,4)(1,nt,2,4)(2,ot,1,1,"wallmine-chart",12)(3,at,3,6)(4,rt,3,6),t&2){let o=h();C(o.selectedChart===1?0:-1),l(),C(o.selectedChart===2?1:-1),l(),C(o.selectedChart===3?2:-1),l(),C(o.selectedChart===4?3:-1),l(),C(o.selectedChart===5?4:-1)}}function st(t,n){if(t&1&&p(0,"info-card",14)(1,"div",15),t&2){let o=n.$implicit;r("value",o.fromGrade+" --> "+o.toGrade)("subtitle",o.symbol)("subtitleChip",!0)("additionalInfo",o.firm)("date",(o.epochGradeDate*1e3).toString())("icon",o.icon)("color",o.color)}}function ct(t,n){if(t&1&&p(0,"info-card",14)(1,"div",15),t&2){let o=n.$implicit;r("value",o.shares.fmt+" shares. "+o.transactionText)("subtitle",o.symbol)("subtitleChip",!0)("additionalInfo",o.filerName+", "+o.filerRelation)("date",(o.startDate.raw*1e3).toString())("icon",o.icon)("color",o.color)}}var vt=(()=>{let n=class n{constructor(e,i){this.alpacaApiService=e,this.dataService=i,this.selectedChart=1,this.gradingHistory=[],this.insiderActivities=[]}ngOnInit(){this.dataService.portfolioDataArray.forEach(e=>{let i={up:"thumb_up",down:"thumb_down",main:"thumbs_up_down",reit:"thumbs_up_down"};if(e.quoteType==="EQUITY"){let m=Object.values(e.upgradeDowngradeHistory).filter(a=>new Date(a.epochGradeDate*1e3).getFullYear()===new Date().getFullYear()).map(a=>(a.symbol=e.symbol,a.icon=i[a.action],a.action==="up"&&(a.color="teal"),a.action==="down"&&(a.color="chocolate"),a));this.gradingHistory.push(...m);let d=e.insiderTransactions;d.length>0&&this.insiderActivities.push(...d.filter(a=>new Date(a.startDate.raw*1e3).getFullYear()===new Date().getFullYear()&&(a.transactionText.startsWith("Purchase")||a.transactionText.startsWith("Sale"))).map(a=>(a.symbol=e.symbol,a.transactionText.startsWith("Purchase")?(a.icon="sentiment_very_satisfied",a.color="teal"):a.transactionText.startsWith("Sale")&&(a.icon="sentiment_very_dissatisfied",a.color="chocolate"),a)))}}),this.gradingHistory.sort((e,i)=>i.epochGradeDate-e.epochGradeDate),this.insiderActivities.sort((e,i)=>i.startDate.raw-e.startDate.raw)}selectChart(e){this.selectedChart=e}};n.\u0275fac=function(i){return new(i||n)(g($),g(y))},n.\u0275cmp=R({type:n,selectors:[["app-portfolio-main"]],standalone:!0,features:[A],decls:18,vars:3,consts:[["titleContentRef",""],["indexCharts",""],[1,"add-margin"],["title","Market Charts",3,"mainContentRef","titleContentRef"],["mat-align-tabs","center"],["label","Quotes"],[3,"expandWidget"],["label","Grading History"],["label","Insider Activities"],[1,"add-flex"],["selected","",3,"click"],[3,"click"],[3,"symbol"],[3,"symbol","width"],[3,"value","subtitle","subtitleChip","additionalInfo","date","icon","color"],[1,"spacer"]],template:function(i,m){if(i&1&&(x(0,et,12,0,"ng-template",null,0,E)(2,lt,5,5,"ng-template",null,1,E),s(4,"section",2),p(5,"container-card",3),c(),s(6,"mat-tab-group",4)(7,"mat-tab",5)(8,"section",2),p(9,"portfolio-quotes",6),c()(),s(10,"mat-tab",7)(11,"section",2),v(12,st,2,7,null,null,Z),c()(),s(14,"mat-tab",8)(15,"section",2),v(16,ct,2,7,null,null,tt),c()()()),i&2){let d=D(1),a=D(3);l(5),r("mainContentRef",a)("titleContentRef",d),l(4),r("expandWidget",!0),l(3),T(m.gradingHistory),l(4),T(m.insiderActivities)}},dependencies:[F,W,j,X,Y,U,G,N,B,K],styles:[".grading-history-container[_ngcontent-%COMP%]{display:flex}.spacer[_ngcontent-%COMP%]{height:.5rem}info-card[_ngcontent-%COMP%]{min-width:fit-content}"]});let t=n;return t})();export{vt as a};
