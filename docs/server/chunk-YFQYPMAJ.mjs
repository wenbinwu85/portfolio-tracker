import './polyfills.server.mjs';
import{b as O}from"./chunk-GHX6AQI4.mjs";import{a as Y}from"./chunk-ACAO5GUR.mjs";import{a as A,b as F,f as R}from"./chunk-BLSGR4UN.mjs";import{k as G}from"./chunk-GDAWZ5KX.mjs";import{i as P}from"./chunk-ZU7M623O.mjs";import{c as f}from"./chunk-KCXLRTQF.mjs";import{f as j}from"./chunk-FPTZ3QXF.mjs";import{a as E,b as w,c as M}from"./chunk-AVKGUBA5.mjs";import{Ab as g,B as _,Bb as C,Cb as c,Db as p,Eb as m,M as T,X as D,Xb as b,Ya as d,Yb as H,Za as u,aa as h,bc as I,fa as S,jc as y,l as v,qb as x,sb as l}from"./chunk-QSEKS3E2.mjs";var k=(()=>{let i=class i{constructor(t,r){this.http=t,this.dataService=r,this.apiBaseUrl="https://data.alpaca.markets",this.apiKey="PK41CNLBVKS2CHYHD6FQ",this.secretKey="hOurdDodVN23wnjowMOyXYjeaobsmIbXtqhOwSbE",this.httpHeaders=new E().set("APCA-API-KEY-ID",this.apiKey).set("APCA-API-SECRET-KEY",this.secretKey)}error(t){let r=t.error instanceof ErrorEvent?t.error.message:`Error Code: ${t.status} Message: ${t.message}`;return v({data:[],message:r,status:500})}wrapHttpCall(t,r){return this.http.get(t,r).pipe(T(2),_(this.error))}getLatestBars(){let t=this.dataService.portfolioSymbols,r=this.apiBaseUrl+"/v2/stocks/bars/latest",n=new w().appendAll({symbols:t.join(","),feed:"iex"}),s={headers:this.httpHeaders,params:n};return this.wrapHttpCall(r,s)}getNews(t,r,n,s){let e=this.apiBaseUrl+"/v1beta1/alpaca/fetch/news/",K=new w().appendAll({symbols:t.join(","),start:r,end:n,limit:s}),W={headers:this.httpHeaders,params:K};return this.wrapHttpCall(e,W)}};i.\u0275fac=function(r){return new(r||i)(h(M),h(f))},i.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var B=(o,i)=>i.epochGradeDate,N=(o,i)=>i.index;function Q(o,i){o&1&&m(0,"tv-symbol-overview-widget",9),o&2&&l("company","VIX Volatility")("symbol","EIGHTCAP:VIX")("timeFrame","1m")}function X(o,i){o&1&&(c(0,"div",10)(1,"a",11)(2,"span",12),H(3,"Track all markets on TradingView"),p()()())}function q(o,i){if(o&1&&m(0,"info-card",13)(1,"div",14),o&2){let a=i.$implicit;l("value",a.fromGrade+" --> "+a.toGrade)("subtitle",a.symbol)("subtitleChip",!0)("additionalInfo",a.firm)("date",(a.epochGradeDate*1e3).toString())("icon",a.icon)("color",a.color)}}function L(o,i){if(o&1&&m(0,"info-card",13)(1,"div",14),o&2){let a=i.$implicit;l("value",a.shares.fmt+" shares. "+a.transactionText)("subtitle",a.symbol)("subtitleChip",!0)("additionalInfo",a.filerName+", "+a.filerRelation)("date",(a.startDate.raw*1e3).toString())("icon",a.icon)("color",a.color)}}var ct=(()=>{let i=class i{constructor(t,r){this.alpacaApiService=t,this.dataService=r,this.selectedChart=1,this.gradingHistory=[],this.insiderActivities=[]}ngOnInit(){this.dataService.portfolioDataArray.forEach(t=>{let r={up:"thumb_up",down:"thumb_down",main:"thumbs_up_down",reit:"thumbs_up_down"};if(t.quoteType==="EQUITY"){let n=Object.values(t.upgradeDowngradeHistory).filter(e=>new Date(e.epochGradeDate*1e3).getFullYear()===new Date().getFullYear()).map(e=>(e.symbol=t.symbol,e.icon=r[e.action],e.action==="up"&&(e.color="teal"),e.action==="down"&&(e.color="chocolate"),e));this.gradingHistory.push(...n);let s=t.insiderTransactions;s.length>0&&this.insiderActivities.push(...s.filter(e=>new Date(e.startDate.raw*1e3).getFullYear()===new Date().getFullYear()&&(e.transactionText.startsWith("Purchase")||e.transactionText.startsWith("Sale"))).map(e=>(e.symbol=t.symbol,e.transactionText.startsWith("Purchase")?(e.icon="sentiment_very_satisfied",e.color="teal"):e.transactionText.startsWith("Sale")&&(e.icon="sentiment_very_dissatisfied",e.color="chocolate"),e)))}}),this.gradingHistory.sort((t,r)=>r.epochGradeDate-t.epochGradeDate),this.insiderActivities.sort((t,r)=>r.startDate.raw-t.startDate.raw)}selectChart(t){this.selectedChart=t}};i.\u0275fac=function(r){return new(r||i)(u(k),u(f))},i.\u0275cmp=S({type:i,selectors:[["app-portfolio-main"]],standalone:!0,features:[I],decls:18,vars:3,consts:[["marketChartsRef",""],["marketChartsFooterRef",""],[1,"add-margin"],["title","Volatility Index",3,"mainContentRef","footerContentRef"],["mat-align-tabs","center"],["label","Quotes"],[3,"expandWidget"],["label","Grading History"],["label","Insider Activities"],[3,"company","symbol","timeFrame"],[1,"tradingview-widget-copyright"],["href","https://www.tradingview.com/","rel","noopener nofollow","target","_blank"],[1,"blue-text"],[3,"value","subtitle","subtitleChip","additionalInfo","date","icon","color"],[1,"spacer"]],template:function(r,n){if(r&1&&(x(0,Q,1,3,"ng-template",null,0,y)(2,X,4,0,"ng-template",null,1,y),c(4,"section",2),m(5,"container-card",3),p(),c(6,"mat-tab-group",4)(7,"mat-tab",5)(8,"section",2),m(9,"portfolio-quotes",6),p()(),c(10,"mat-tab",7)(11,"section",2),g(12,q,2,7,null,null,B),p()(),c(14,"mat-tab",8)(15,"section",2),g(16,L,2,7,null,null,N),p()()()),r&2){let s=b(1),e=b(3);d(5),l("mainContentRef",s)("footerContentRef",e),d(4),l("expandWidget",!0),d(3),C(n.gradingHistory),d(4),C(n.insiderActivities)}},dependencies:[j,G,P,R,A,F,O,Y],styles:[".grading-history-container[_ngcontent-%COMP%]{display:flex}.spacer[_ngcontent-%COMP%]{height:.5rem}info-card[_ngcontent-%COMP%]{min-width:fit-content}"]});let o=i;return o})();export{ct as a};
