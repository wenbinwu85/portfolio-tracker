import './polyfills.server.mjs';
import{b as B}from"./chunk-DLDUCTXX.mjs";import{a as F,b as T,c as $,d as j}from"./chunk-XI2MHXQO.mjs";import{a as z}from"./chunk-YL2C5GQR.mjs";import{a as b,b as P}from"./chunk-JFMXPXXG.mjs";import{a as E}from"./chunk-PBBBDJEU.mjs";import{N as I,O as w}from"./chunk-WH4NKODO.mjs";import{l as D,q as O}from"./chunk-5LWACEDN.mjs";import{$b as _,Cb as r,Db as o,Eb as m,Fb as u,Gb as g,Wb as d,Xb as S,ab as s,bb as M,ec as x,gc as y,ja as C,rb as f,tb as c}from"./chunk-CTKXV6KZ.mjs";function V(i,a){if(i&1&&(r(0,"div",8),m(1,"info-card",9),o()),i&2){let n=a.$implicit;s(),c("icon","article")("value",n.title)("subtitle",n.symbol)("date",n.displayTime)("fontSize","1rem")("color","slategrey")("accentColor","slategrey")}}function k(i,a){if(i&1&&(u(0),m(1,"info-card",12),g()),i&2){let n=a.$implicit;s(),c("icon",n.icon)("value",n.name)("subtitle",n.event)("additionalInfo",n.detail)("fontSize","1rem")("color",n.color)("accentColor",n.color)}}function A(i,a){if(i&1&&(u(0),r(1,"div",10),d(2),x(3,"date"),o(),r(4,"div",11),f(5,k,2,7,"ng-container",7),o(),g()),i&2){let n=a.$implicit;s(2),S(y(3,2,n[0],"MMMM d, EEEE")),s(3),c("ngForOf",n[1])}}var ne=(()=>{let a=class a{constructor(p){this.dataService=p,this.events=[],this.eventDates=[],this.mappedEvents={},this.corporateEvents=[]}ngOnInit(){Object.values(this.dataService.portfolioData).filter(e=>e.quoteType==="EQUITY").forEach(e=>{this.dataService.getCorporateEvents(e.symbol,!0).subscribe(t=>{this.corporateEvents.push(...t[e.symbol]),this.corporateEvents.sort((v,h)=>h.time-v.time)})}),Object.values(this.dataService.portfolioData).filter(e=>e.calendarEvents).forEach(e=>{let t=e.calendarEvents,v=e.earnings.earningsChart,h=this.dataService.portfolioHoldings[e.symbol];if(t.exDividendDate){let l=(e.dividendYield*100).toFixed(2);this.events.push({name:e.shortName,date:new Date(t.exDividendDate).valueOf(),event:"Ex-Dividend",icon:"rule",color:"sienna",detail:`Yield: ${l}%`})}if(t.dividendDate){let l=(e.lastDividendValue*h.sharesOwned).toFixed(2);this.events.push({name:e.shortName,date:new Date(t.dividendDate).valueOf(),event:"Dividend",icon:"attach_money",color:"darkcyan",detail:`Income: $${l}`})}if(t.earnings.earningsDate[0]){let l=`${v.currentQuarterEstimateDate} estimate: ${v.currentQuarterEstimate}`;this.events.push({name:e.shortName,date:new Date(t.earnings?.earningsDate[0]?.slice(0,-2)).valueOf(),event:"Earnings",icon:"insights",color:"slategrey",detail:l})}}),this.events=this.events.filter(e=>e.date>=new Date().valueOf()),this.events.sort((e,t)=>e.date-t.date),this.events.forEach(e=>{this.eventDates.push(e.date)}),this.eventDates=new Set(this.eventDates),this.eventDates=Array.from(this.eventDates),this.eventDates.forEach(e=>{this.mappedEvents[e]=this.events.filter(t=>t.date===e)}),this.mappedEvents=Object.entries(this.mappedEvents)}};a.\u0275fac=function(e){return new(e||a)(M(E))},a.\u0275cmp=C({type:a,selectors:[["app-portfolio-main"]],standalone:!0,features:[_],decls:22,vars:4,consts:[[3,"expanded"],[1,"add-border","main-section"],[1,"news-container"],["class","add-margin",4,"ngFor","ngForOf"],["vertical",""],[1,"events-container"],[1,"add-margin","date-contianer"],[4,"ngFor","ngForOf"],[1,"add-margin"],[3,"icon","value","subtitle","date","fontSize","color","accentColor"],[1,"event-date"],[1,"event-container"],[3,"icon","value","subtitle","additionalInfo","fontSize","color","accentColor"]],template:function(e,t){e&1&&(r(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon"),d(4,"auto_graph"),o(),r(5,"span"),d(6,"Price Change"),o()()(),m(7,"price-movement-charts"),o(),r(8,"mat-expansion-panel",0)(9,"mat-expansion-panel-header")(10,"mat-panel-title")(11,"mat-icon"),d(12,"auto_graph"),o(),r(13,"span"),d(14,"Corporate Events"),o()()(),r(15,"section",1)(16,"div",2),f(17,V,2,7,"div",3),o(),m(18,"mat-divider",4),r(19,"div",5)(20,"div",6),f(21,A,6,5,"ng-container",7),o()()()()),e&2&&(c("expanded",!0),s(8),c("expanded",!0),s(9),c("ngForOf",t.corporateEvents),s(4),c("ngForOf",t.mappedEvents))},dependencies:[O,z,P,b,j,F,T,$,w,I,D,B],styles:[".main-section[_ngcontent-%COMP%]{display:flex}.news-container[_ngcontent-%COMP%], .events-container[_ngcontent-%COMP%]{max-width:50vw}.day-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.event-date[_ngcontent-%COMP%]{padding-bottom:.5rem}.event-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding-bottom:10px}"]});let i=a;return i})();export{ne as a};
